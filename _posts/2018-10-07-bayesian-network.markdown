---
layout: post
title:  "Байесовские сети"
date:   2018-10-07 10:15:54 +0300
categories: jekyll update
author: Teman Zampano
---

Байесовская сеть (или байесова сеть, байесовская сеть доверия, англ. Bayesian network, belief network) — графовая вероятностная модель, представляющая собой множество переменных и их вероятностных зависимостей по Байесу. Например, байесовская сеть может быть использована для вычисления вероятности того, чем болен пациент по наличию или отсутствию ряда симптомов, основываясь на данных о зависимости между симптомами и болезнями. Математический аппарат байесовых сетей создан американским учёным Джудой Перлом, лауреатом Премии Тьюринга (2011)

Формально, байесовская сеть — это направленный ациклический граф, каждой вершине которого соответствует случайная переменная, а дуги графа кодируют отношения условной независимости между этими переменными. Вершины могут представлять переменные любых типов, быть взвешенными параметрами, скрытыми переменными или гипотезами. Существуют эффективные методы, которые используются для вычислений и обучения байесовских сетей. Если переменные байесовской сети являются дискретными случайными величинами, то такая сеть называется дискретной байесовской сетью. Байесовские сети, которые моделируют последовательности переменных, называют динамическими байесовскими сетями. Байесовские сети, в которых могут присутствовать как дискретные переменные, так и непрерывные, называются гибридными байесовскими сетями. Байесовская сеть, в которой дуги помимо отношений условной независимости кодируют также отношения причинности, называют причинно-следственными байесовыми сетями (англ. causal bayesian networks)

#Определения и принципы работы 

Если из вершины A выходит дуга в вершину B, то A называют родителем B, а B называют потомком A. Если из вершины A существует ориентированный путь в вершину B, то A называется предком B, а B называется потомком A. Множество вершин-родителей вершины Vi обозначим как 
>parents(Vi) = PAi.

Направленный ациклический граф G называется байесовской сетью для вероятностного распределения P(v), заданного над множеством случайных переменных V, если каждой вершине графа поставлена в соответствие случайная переменная из V, а дуги в графе удовлетворяют условию (*марковское условие*): любая переменная Vi из V должна быть условно независима от всех вершин, не являющихся её потомками, если заданы (получили означивание, обусловлены) все её прямые родители PAi в графе G, то есть

>∀Vi ∈ V справедливо: P(vi│pai,s) = P(vi│pai),

где vi — значение Vi; s — конфигурация S; S — множество всех вершин, не являющихся потомками Vi; pai — конфигурация PAi.

Тогда полное совместное распределение значений в вершинах можно удобно записать в виде декомпозиции (произведения) локальных распределений: 

![bayesian](/assets/bayesian.png)

Если у вершины Vi нет предков, то её локальное распределение вероятностей называют безусловным, иначе условным. Если вершина — случайная переменная получила означивание (например, в результате наблюдения), то такое означивание называют свидетельством (англ. evidence). Если значение переменной было установлено извне (а не наблюдалось), то такое означивание называется вмешательством (англ. action) или интервенцией (англ. intervention)

Байесовская сеть позволяет получить ответы на следующие типы *вероятностных запросов*:

    нахождение вероятности свидетельства,
    определение априорных маргинальных вероятностей,
    определение апостериорных маргинальных вероятностей, включая:
    прогнозирование, или прямой вывод, — определение вероятности события при наблюдаемых причинах,
    диагностирование, или обратный вывод (абдукция), — определение вероятности причины при наблюдаемых следствиях,
    межпричинный (смешанный) вывод (англ. intercausal inference) или трансдукция, — определение вероятности одной из причин наступившего события при условии наступления одной или нескольких других причин этого события.
    вычисление наиболее вероятного объяснения наблюдаемого события (англ. most probable explanation, MPE),
    вычисление апостериорного максимума (англ. maximum a-posteriori, MAP).



# ** Пример байесовской сети ** 

Предположим, что может быть две причины, по которым трава может стать мокрой (GRASS WET): сработала дождевальная установка, либо прошёл дождь. Также предположим, что дождь влияет на работу дождевальной машины (во время дождя установка не включается). Тогда ситуация может быть смоделирована проиллюстрированной Байесовской сетью. Каждая из трёх переменных может принимать лишь одно из двух возможных значений: T (правда — true) и F (ложь — false), с вероятностями, указанными в таблицах на иллюстрации.

Совместная вероятность функции:

![sovm](/assets/sovmestnaya.png)

где имена трёх переменных означают G = Трава мокрая (Grass wet), S = Дождевальная установка (Sprinkler), и R = Дождь (Rain).

Модель может ответить на такие вопросы как «Какова вероятность того, что прошел дождь, если трава мокрая?» используя формулу условной вероятности и суммируя переменные: 

![summa](/assets/sum.png)


В силу того, что байесовская сеть — это полная модель для переменных и их отношений, она может быть использована для того, чтобы давать ответы на вероятностные вопросы. Например, сеть можно использовать, чтобы получить новое знание о состоянии подмножества переменных, наблюдая за другими переменными (переменные-свидетельства). Это процесс вычисления апостериорного распределения переменных по переменным-свидетельствам называют вероятностным выводом. Это следствие даёт нам универсальную оценку для приложений, где нужно выбрать значения подмножества переменных, которое минимизирует функцию потерь, например, вероятность ошибочного решения. Байесовская сеть может также считаться механизмом для автоматического построения расширения теоремы Байеса для более сложных задач.

Для проведения вероятностного вывода в байесовских сетях используются следующие алгоритмы:

    Точные:

        вывод методом грубой силы путём маргинализации полного совместного распределения;
        алгоритмы устранения переменных и символьные вычисления,
        кластеризация,
        алгоритмы пропагации (передача) сообщений между узлами сети,

    Приближённые на основе метода Монте-Карло:

        алгоритмы формирования выборок с исключением,
        метод оценки выборок с учётом правдоподобия,
        алгоритм МСМС (англ. Markov chain Monte Carlo) и др.


# Приложения байесовских сетей

Байесовские сети используются для моделирования в биоинформатике (генетические сети, структура белков), медицине, классификации документов, обработке изображений, обработке данных, машинном обучении и системах поддержки принятия решений.
<a onclick="window.history.back()">Back</a>
 
